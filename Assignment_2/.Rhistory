geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Theta l") +
theme_classic(),
nrow = 2
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Theta l") +
theme_classic(),
nrow = 4
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Posterior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(x = "Rate", y = "Prior Density", color = "Legend") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), color = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), color = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
fill
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(legned.position = "bottom"),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(legend.position = "bottom"),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(legend.position = "bottom"),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme(legend.position = "bottom") +
theme_classic(),
nrow = 1
)
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme(legend.position = "bottom") +
theme_classic()
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_l), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_l_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
geom_density(aes(logit_scaled(theta_l), fill = "blue", alpha = 0.3) +
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(theta_w), fill = "blue", alpha = 0.3) +
geom_density(aes(theta_w_prior), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(logit_scaled(theta_l)), fill = "blue", alpha = 0.3) +
geom_density(aes(logit_scaled(theta_l_prior)), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(logit_scaled(theta_w)), fill = "blue", alpha = 0.3) +
geom_density(aes(logit_scaled(theta_w_prior)), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
ylim(0, 5) +
xlim(0, 1) +
geom_density(aes(logit_scaled(theta_l)), fill = "blue", alpha = 0.3) +
geom_density(aes(logit_scaled(theta_l_prior)), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
#ylim(0, 5) +
#xlim(0, 1) +
geom_density(aes(logit_scaled(theta_w)), fill = "blue", alpha = 0.3) +
geom_density(aes(logit_scaled(theta_w_prior)), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.8, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
#ylim(0, 5) +
#xlim(0, 1) +
geom_density(aes(logit_scaled(theta_l)), fill = "blue", alpha = 0.3) +
geom_density(aes(logit_scaled(theta_l_prior)), fill = "red", alpha = 0.3) +
geom_vline(xintercept = 0.9, linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
#ylim(0, 5) +
#xlim(0, 1) +
geom_density(aes(logit_scaled(theta_w)), fill = "blue", alpha = 0.3) +
geom_density(aes(logit_scaled(theta_w_prior)), fill = "red", alpha = 0.3) +
geom_vline(xintercept = logit_scaled(0.8), linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
#ylim(0, 5) +
#xlim(0, 1) +
geom_density(aes(logit_scaled(theta_l)), fill = "blue", alpha = 0.3) +
geom_density(aes(logit_scaled(theta_l_prior)), fill = "red", alpha = 0.3) +
geom_vline(xintercept = logit_scaled(0.9), linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
# Import the data
d <- read.csv("data/simulated_WSLSvsMEM7.csv")
df <- d %>% subset(agent == 100)
# Turn it into a list with n
data <- list(N = 120, selfchoice = df$WSLS, trial = df$trial, oppchoice = df$MEM)
# Specify where the model is
file <- file.path("stan/AssymetricWSLS.stan")
# Compiling the model
mod <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE))
# Commands to call Stan with specific options
samples <- mod$sample(
data = data,
seed = 0901,
chains = 2,
parallel_chains = 2,
threads_per_chain = 2,
iter_warmup = 1000,
refresh = 100,
output_dir = "simmodels",
max_treedepth = 20,
adapt_delta = 0.99
)
# Save the fitted model
samples$save_object("simmodels/AWSLS.rds")
# Load packages
pacman::p_load(tidyverse, ggplot2)
# Summarizing the model
samples <- readRDS("simmodels/AWSLS.rds")
samples$summary()
# Assess model quality
draws_df <- as_draws_df(samples$draws())
# Checking the model's chains
ggplot(draws_df, aes(.iteration, logit_scaled(theta_w), group = .chain, color = .chain)) + geom_line() + labs(title = "Theta w")+ theme_classic()
ggplot(draws_df, aes(.iteration, logit_scaled(theta_l), group = .chain, color = .chain)) + geom_line() + labs(title = "Theta l") + theme_classic()
# predictive prior
gridExtra::grid.arrange(
ggplot(draws_df) +
#ylim(0, 5) +
#xlim(0, 1) +
geom_density(aes(logit_scaled(theta_w)), fill = "blue", alpha = 0.3) +
geom_density(aes(logit_scaled(theta_w_prior)), fill = "red", alpha = 0.3) +
geom_vline(xintercept = logit_scaled(0.8), linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "Predictive prior", subtitle = "Theta w") +
theme_classic(),
ggplot(draws_df) +
#ylim(0, 5) +
#xlim(0, 1) +
geom_density(aes(logit_scaled(theta_l)), fill = "blue", alpha = 0.3) +
geom_density(aes(logit_scaled(theta_l_prior)), fill = "red", alpha = 0.3) +
geom_vline(xintercept = logit_scaled(0.9), linetype = "dashed", color = "black", size = 1.5) +
xlab("Rate") +
ylab("Prior Density") +
labs(title = "", subtitle = "Theta l") +
theme_classic(),
nrow = 1
)
